<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linear Regression - Machine Learning Cookbook(V2)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/v4-shims.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#8B5CF6',
                        accent: '#10B981',
                        neutral: '#6B7280',
                        dark: '#1F2937',
                        light: '#F9FAFB'
                    },
                    fontFamily: {
                        code: ['Consolas', 'Monaco', 'monospace'],
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .math-card {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            }
            .code-card {
                background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
            }
            .interactive-card {
                background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            }
            .formula-highlight {
                background: linear-gradient(45deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
                border-left: 4px solid #8B5CF6;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="bg-white rounded-xl shadow-lg p-6">
        <!-- Algorithm Header -->
        <div class="mb-8">
            <div class="flex items-center mb-4">
                <i class="fa fa-line-chart text-3xl text-secondary mr-4"></i>
                <div>
                    <h1 class="text-3xl font-bold text-gray-800">Linear Regression</h1>
                    <p class="text-gray-600">Supervised Learning - Regression Algorithm</p>
                </div>
            </div>
            <div class="flex flex-wrap gap-2 mb-4">
                <span class="bg-secondary/10 text-secondary px-3 py-1 rounded-full text-sm">Regression</span>
                <span class="bg-primary/10 text-primary px-3 py-1 rounded-full text-sm">Linear Model</span>
                <span class="bg-accent/10 text-accent px-3 py-1 rounded-full text-sm">Least Squares</span>
                <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm">Normal Equation</span>
            </div>
        </div>

        <!-- Algorithm Overview -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Algorithm Overview</h2>
            <div class="bg-gray-50 p-6 rounded-lg">
                <p class="text-gray-700 mb-4">
                    Linear Regression is a linear approach to modeling the relationship between a scalar response (dependent variable) 
                    and one or more explanatory variables (independent variables).
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="font-bold text-gray-800 mb-2">Key Characteristics</h3>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Predicts continuous values</li>
                            <li>Assumes linear relationship</li>
                            <li>Minimizes squared error</li>
                            <li>Simple and interpretable</li>
                            <li>Foundation for many ML algorithms</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-800 mb-2">Applications</h3>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Predicting house prices</li>
                            <li>Stock price forecasting</li>
                            <li>Sales prediction</li>
                            <li>Weather forecasting</li>
                            <li>Medical outcome prediction</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mathematical Foundations -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Mathematical Foundations</h2>
            
            <!-- Linear Model -->
            <div class="mb-6">
                <h3 class="text-xl font-bold text-gray-800 mb-3">1. Linear Model</h3>
                <div class="formula-highlight p-4 rounded-lg mb-4">
                    <p class="text-lg font-mono">\[ \hat{y} = \theta_0 + \theta_1 x_1 + \theta_2 x_2 + \dots + \theta_n x_n \]</p>
                    <p class="text-gray-600 text-sm mt-2">Vector form: \( \hat{y} = \theta^T X \) where \( X = [1, x_1, x_2, \dots, x_n]^T \)</p>
                </div>
            </div>

            <!-- Cost Function -->
            <div class="mb-6">
                <h3 class="text-xl font-bold text-gray-800 mb-3">2. Cost Function (MSE)</h3>
                <div class="formula-highlight p-4 rounded-lg mb-4">
                    <p class="text-lg font-mono">\[ J(\theta) = \frac{1}{2m} \sum_{i=1}^{m} (\hat{y}^{(i)} - y^{(i)})^2 \]</p>
                    <p class="text-gray-600 text-sm mt-2">Mean Squared Error (MSE) measures the average squared difference between predictions and actual values</p>
                </div>
            </div>

            <!-- Normal Equation -->
            <div class="mb-6">
                <h3 class="text-xl font-bold text-gray-800 mb-3">3. Normal Equation Solution</h3>
                <div class="formula-highlight p-4 rounded-lg mb-4">
                    <p class="text-lg font-mono">\[ \theta = (X^T X)^{-1} X^T y \]</p>
                    <p class="text-gray-600 text-sm mt-2">Direct solution without iteration, works well for small datasets</p>
                </div>
            </div>

            <!-- Gradient Descent -->
            <div class="mb-6">
                <h3 class="text-xl font-bold text-gray-800 mb-3">4. Gradient Descent</h3>
                <div class="formula-highlight p-4 rounded-lg mb-4">
                    <p class="text-lg font-mono">\[ \theta_j := \theta_j - \alpha \frac{\partial J(\theta)}{\partial \theta_j} \]</p>
                    <p class="text-lg font-mono mt-2">\[ \frac{\partial J(\theta)}{\partial \theta_j} = \frac{1}{m} \sum_{i=1}^{m} (\hat{y}^{(i)} - y^{(i)}) x_j^{(i)} \]</p>
                    <p class="text-gray-600 text-sm mt-2">Iterative optimization method for large datasets</p>
                </div>
                
                <!-- Interactive Gradient Descent Demo -->
                <div class="bg-white p-4 rounded-lg shadow-md mb-4">
                    <canvas id="gradientChart" width="400" height="200"></canvas>
                </div>
            </div>

            <!-- Regularization -->
            <div class="mb-6">
                <h3 class="text-xl font-bold text-gray-800 mb-3">5. Regularization</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="formula-highlight p-4 rounded-lg">
                        <h4 class="font-bold text-gray-800 mb-2">L1 Regularization (Lasso)</h4>
                        <p class="text-lg font-mono">\[ J(\theta) = \frac{1}{2m} \sum_{i=1}^{m} (\hat{y}^{(i)} - y^{(i)})^2 + \lambda \sum_{j=1}^{n} |\theta_j| \]</p>
                    </div>
                    <div class="formula-highlight p-4 rounded-lg">
                        <h4 class="font-bold text-gray-800 mb-2">L2 Regularization (Ridge)</h4>
                        <p class="text-lg font-mono">\[ J(\theta) = \frac{1}{2m} \sum_{i=1}^{m} (\hat{y}^{(i)} - y^{(i)})^2 + \frac{\lambda}{2m} \sum_{j=1}^{n} \theta_j^2 \]</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Implementation -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Implementation</h2>
            
            <!-- Python Code -->
            <div class="code-card text-white p-6 rounded-lg mb-6">
                <pre class="font-code text-sm overflow-x-auto"><code>import numpy as np
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score

# Sample data
X = np.array([[1], [2], [3], [4], [5], [6], [7], [8], [9], [10]])
y = np.array([2, 4, 5, 4, 5, 7, 8, 9, 10, 12])

# Split data
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Create and train model
model = LinearRegression()
model.fit(X_train, y_train)

# Make predictions
y_pred = model.predict(X_test)

# Evaluate
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)
print(f"MSE: {mse:.2f}")
print(f"R2 Score: {r2:.2f}")

# Model coefficients
print("Coefficients:", model.coef_)
print("Intercept:", model.intercept_)

# Plotting (optional)
import matplotlib.pyplot as plt
plt.scatter(X, y, color='blue')
plt.plot(X, model.predict(X), color='red')
plt.show()</code></pre>
            </div>

            <!-- Interactive Demo -->
            <div class="interactive-card text-white p-6 rounded-lg">
                <h3 class="text-xl font-bold mb-4">Interactive Demo</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block mb-2 font-bold">Input Value:</label>
                        <input type="number" id="inputValue" value="5" class="w-full p-2 rounded-lg mb-4 text-gray-800">
                        
                        <button onclick="predictValue()" class="bg-white text-green-600 px-4 py-2 rounded-lg hover:bg-gray-100 transition-colors duration-200 font-bold">
                            Predict
                        </button>
                    </div>
                    <div id="predictionResult" class="bg-white p-4 rounded-lg text-gray-800">
                        <h4 class="font-bold mb-2">Prediction Result</h4>
                        <p id="resultText" class="text-lg">Click Predict to see results</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mathematical Theory Card -->
        <div class="math-card text-white p-6 rounded-lg mb-8">
            <h3 class="text-xl font-bold mb-4">Mathematical Theory</h3>
            <div class="space-y-4">
                <div>
                    <h4 class="font-bold mb-2">Geometric Interpretation</h4>
                    <p class="text-sm">Linear regression finds the hyperplane that minimizes the sum of squared distances to all data points. This is equivalent to projecting the target vector onto the column space of the feature matrix.</p>
                </div>
                <div>
                    <h4 class="font-bold mb-2">Assumptions</h4>
                    <ul class="list-disc list-inside text-sm space-y-1">
                        <li>Linearity: Relationship between features and target is linear</li>
                        <li>Independence: Observations are independent of each other</li>
                        <li>Homoscedasticity: Constant variance of errors</li>
                        <li>Normality: Errors are normally distributed</li>
                        <li>No multicollinearity: Features are not highly correlated</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-2">Statistical Properties</h4>
                    <p class="text-sm">Under the Gauss-Markov assumptions, the ordinary least squares estimator is the Best Linear Unbiased Estimator (BLUE).</p>
                </div>
            </div>
        </div>

        <!-- Evaluation Metrics -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Evaluation Metrics</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="bg-white p-4 rounded-lg shadow-md text-center">
                    <i class="fa fa-square text-2xl text-red-500 mb-2"></i>
                    <h3 class="font-bold text-gray-800 mb-1">MSE</h3>
                    <p class="text-sm text-gray-600">Mean Squared Error</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md text-center">
                    <i class="fa fa-square-root-o text-2xl text-blue-500 mb-2"></i>
                    <h3 class="font-bold text-gray-800 mb-1">RMSE</h3>
                    <p class="text-sm text-gray-600">Root Mean Squared Error</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md text-center">
                    <i class="fa fa-percent text-2xl text-green-500 mb-2"></i>
                    <h3 class="font-bold text-gray-800 mb-1">R² Score</h3>
                    <p class="text-sm text-gray-600">Coefficient of Determination</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md text-center">
                    <i class="fa fa-balance-scale text-2xl text-purple-500 mb-2"></i>
                    <h3 class="font-bold text-gray-800 mb-1">MAE</h3>
                    <p class="text-sm text-gray-600">Mean Absolute Error</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Gradient descent visualization
        function plotGradientDescent() {
            const ctx = document.getElementById('gradientChart').getContext('2d');
            
            // Generate cost function data
            const thetaValues = [];
            const costValues = [];
            for (let theta = -2; theta <= 4; theta += 0.1) {
                thetaValues.push(theta);
                // Simple quadratic cost function
                costValues.push(0.5 * Math.pow(theta - 1.5, 2));
            }
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: thetaValues,
                    datasets: [{
                        label: 'Cost Function',
                        data: costValues,
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    backgroundColor: '#FFFFFF',
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'θ'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'J(θ)'
                            },
                            min: 0
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Gradient Descent Optimization'
                        }
                    }
                }
            });
        }

        // Interactive prediction demo
        function predictValue() {
            const input = parseFloat(document.getElementById('inputValue').value);
            
            // Simple linear regression model: y = 1.2x + 0.5
            const prediction = 1.2 * input + 0.5;
            
            const resultText = document.getElementById('resultText');
            resultText.innerHTML = `
                <div class="space-y-2">
                    <p>Predicted Value: ${prediction.toFixed(2)}</p>
                    <p>Model: y = 1.2x + 0.5</p>
                </div>
            `;
        }

        // Initialize charts when page loads
        document.addEventListener('DOMContentLoaded', function() {
            plotGradientDescent();
        });
    </script>
</body>
</html>